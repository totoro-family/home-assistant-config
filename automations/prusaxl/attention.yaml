- id: prusaxl_attention
  alias: "[PrusaXL] Attention"
  variables:
    snapshot_create_file_path: "/config/www/tmp/snapshot_prusaxl.jpg"
    snapshot_access_file_path: "{{ snapshot_create_file_path | replace('/config/www','/local') }}"
  trigger:
    - trigger: state
      to: "attention"
      entity_id: sensor.prusaxl
  action:
    - action: camera.snapshot
      entity_id: camera.prusaxl_preview
      data:
        filename: "{{ snapshot_create_file_path }}"
    - action: notify.notify
      data:
        message: "clear_notification"
        data:
          tag: "prusaxl_attention"
    - action: notify.notify
      data:
        title: "PrusaXL needs attention"
        data:
          url: "/lovelace/printing"
          image: "{{ snapshot_access_file_path }}"
          tag: prusaxl_attention
