- id: prusheen_print_failed
  alias: "[Prusheen] Print failed"
  trigger:
    - platform: state
      from: "on"
      to: "unavailable"
      entity_id: binary_sensor.prusheen_printing
  condition:
    not:
    - condition: state
      entity_id: sensor.prusheen_job_percentage
      state: "100.0"
  action:
    - service: notify.notify
      data:
        message: "clear_notification"
        data:
          tag: "prusheen_print_finished"
    - service: notify.notify
      data:
        title: "Prusheen print likely failed"
        message: "Printer is offline"
        data:
          url: "/lovelace/prusheen"
          image: http://octopi.totoro.family:8080/stream/snapshot.jpeg
          tag: prusheen_print_failed
